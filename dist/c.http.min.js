/** @license
 * protocore-js <https://github.com/dzonzbonz/ProtoCoreJS>
 * Author: Nikola Ivanovic - Dzonz Bonz | MIT License
 * v0.0.1 (2015/06/23 14:26)
 */
;(function(){var a=function(a){return a.Http={namespace:"C.Http"},a.mode(a.Http,"namespace",a.MODE_LOCKED),a.Http.Data=function(){this.toString=function(){},this.fromString=function(a){},this.toQuery=function(){},this.fromQuery=function(a){},this.toStream=function(){},this.fromStream=function(a){}},a.Http.Data.prototype=new a.Enviroment.Object,a.Http.Data.prototype.constructor=a.Http.Data,a.factory(a.Http,"Data",function(){var b={xWwwFormUrlEncoded:function(a){var b=String(a).replace(/^&/,"").replace(/&$/,"").split("&"),c=b.length,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=function(a){return decodeURIComponent(a.replace(/\+/g,"%20"))},t={};for(d=0;d<c;d++){m=b[d].split("="),n=s(m[0]),o=m.length<2?"":s(m[1]);while(n.charAt(0)===" ")n=n.slice(1);n.indexOf("\0")>-1&&(n=n.slice(0,n.indexOf("\0")));if(n&&n.charAt(0)!=="["){q=[],p=0;for(e=0;e<n.length;e++)if(n.charAt(e)==="["&&!p)p=e+1;else if(n.charAt(e)==="]"&&p){q.length||q.push(n.slice(0,p-1)),q.push(n.substr(p,e-p)),p=0;if(n.charAt(e+1)!=="[")break}q.length||(q=[n]);for(e=0;e<q[0].length;e++){l=q[0].charAt(e);if(l===" "||l==="."||l==="[")q[0]=q[0].substr(0,e)+"_"+q[0].substr(e+1);if(l==="[")break}i=t;for(e=0,r=q.length;e<r;e++){n=q[e].replace(/^['"]/,"").replace(/['"]$/,""),j=e!==q.length-1,h=i;if(n!==""&&n!==" "||e===0)i[n]===k&&(i[n]={}),i=i[n];else{f=-1;for(g in i)i.hasOwnProperty(g)&&+g>f&&g.match(/^\d+$/g)&&(f=+g);n=f+1}}h[n]=o}}return t},applicationJson:function(a){return JSON.parse(a)}},c={multipartFormData:function(b,c,d,e){var e=a.isDefined(e)?e:a.guid(4);d=a.isDefined(d)?d:1;var f="",g=this;return a.traverse(b,function(b,h){var i=a.isDefined(c)&&c!=null?c+"["+b+"]":b;f+=a.isObject(h)||a.isArray(h)?g.multipartFormData(h,i,d+1,e):"--"+e+"\r\nContent-Disposition: form-data; name="+i+"\r\nContent-type: application/octet-stream"+"\r\n\r\n"+h+"\r\n"}),d==1&&(f+="--"+e+"--\r\n"),f},xWwwFormUrlEncoded:function(b,c,d){d=a.isDefined(d)?d:1;var e="",f=this;return a.traverse(b,function(b,g){var h=a.isDefined(c)&&c!=null?c+"["+b+"]":b;e+=a.isObject(g)||a.isArray(g)?f.xWwwFormUrlEncoded(g,h,d+1):(d===1&&e.length===0?"":"&")+encodeURIComponent(h)+"="+encodeURIComponent(g)}),e},applicationJson:function(a){return JSON.stringify(a)}},d=function(){var d=new a.Enviroment.Object;a.extend(this,d),this.toString=function(){return c.applicationJson(this.data())},this.fromString=function(a){this.data(b.applicationJson(a))},this.toQuery=function(){return c.xWwwFormUrlEncoded(this.data())},this.fromQuery=function(a){this.data(b.xWwwFormUrlEncoded(a))},this.toStream=function(){return c.multipartFormData(this.data())},this.fromStream=function(a){}};return d.prototype=new a.Http.Data,d.prototype.constructor=a.Http.Data,d}),a.Http.Uri=function(a){this.parse=function(a){},this.toJSON=function(){},this.build=function(){}},a.factory(a.Http,"Uri",function(){function c(c){var d="",e="",f="",g="",h="",i=new a.Http.Data,j="";this.parse=function(c){var k=b.url(c);return d=a.isDefined(k.protocol)?k.protocol:"",e=a.isDefined(k.host)?k.host:"",f=a.isDefined(k.port)?k.port:"",g=a.isDefined(k.path)?k.path:"",h=a.isDefined(k.query)?k.query:"",i.fromQuery(h),j=a.isDefined(k.hash)?k.hash:"",this},this.toJSON=function(){return{protocol:d,host:e,port:f,path:g,query:h,data:i.data(),hash:j}},this.build=function(){var a=i.toQuery();return d+"//"+e+(f.length>0?":"+f:"")+(g.length>0?"/"+g:"")+(a.length>0?"?"+a:"")+(j.length>0?"#"+j:"")},a.isDefined(c)&&this.parse(c)}var b={anchor:function(a){var b=document.createElement("a");return b.href=a,b},url:function(b,c,d){var e,f=["source","protocol","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","hash"],c=a.isDefined(c)?c:"php",g={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},h=g[c].exec(b),i={},j=14;while(j--)h[j]&&(i[f[j]]=h[j]);if(d)return i[d.toLowerCase()];var k="queryData";return g=/(?:^|&)([^&=]*)=?([^&]*)/g,i[k]={},e=i[f[12]]||"",e.replace(g,function(a,b,c){b&&(i[k][b]=c)}),delete i.source,i},query:function(){}};return c.prototype=new a.Http.Uri,c.prototype.constructor=a.Http.Uri,c}),a.Http.Response=function(){this.getHandle=function(){},this.setHandle=function(a){},this.getState=function(){},this.setState=function(a){},this.isError=function(a){},this.isSuccess=function(a){},this.isDone=function(a){},this.getHeaders=function(){},this.getResponse=function(){}},a.Http.Response.prototype=new a.Enviroment.EventData,a.Http.Response.prototype.constructor=a.Http.Response,a.factory(a.Http,"Response",function(){function c(a){return a.replace(/^\s+|\s+$/gm,"")}var b=function(a){return a.substring(1)!==""},d=function(){var d=0,e=null,f=new a.Enviroment.EventData;a.extend(this,f),this.getState=function(){return this.data("state")},this.setState=function(a){return this.data("state",a),this},this.getHandle=function(){return e},this.setHandle=function(a){return e=a,this},this.getHeaders=function(){var a=e.getAllResponseHeaders(),d={};if(a){a=a.split("\n");for(var f=0;f<a.length;f++)if(b(a[f])){var g=a[f].search(/:\s*/),h=a[f].substring(0,g),i=a[f].substring(g+1);d[c(h)]=c(i)}}return d},this.getResponse=function(){return this.data("response")},this.isDone=function(){var a=this.getState();return a===4},this.isError=function(){return!this.isSuccess()},this.isSuccess=function(){var a=this.data("status"),b=this.getState();return b===4&&a>=200&&a<400};var g=this};return d.prototype=new a.Http.Response,d.prototype.constructor=a.Http.Response,d},a.MODE_LOCKED),a.Http.Request=function(b){this.getUrl=function(){},this.setUrl=function(a){},this.getContent=function(){},this.setContent=function(a){},this.getCharset=function(){},this.setCharset=function(a){},this.getHeaders=function(){},this.setHeaders=function(a){},this.getHeader=function(a){},this.setHeader=function(a,b){},this.getMethod=function(){},this.setMethod=function(a){},this.getMode=function(){},this.setMode=function(a){},this.getSendAs=function(){},this.setSendAs=function(a){},this.getType=function(){},this.setType=function(a){},this.getBypassCache=function(){},this.setBypassCache=function(a){},this.onResponse=new a.Http.Response},a.Http.Request.prototype=new a.Enviroment.Object,a.Http.Request.prototype.constructor=a.Http.Request,a.Http.Request.prototype.MODE_TEXT=1,a.Http.Request.prototype.MODE_BINARY=2,a.Http.Request.prototype.METHOD_GET="GET",a.Http.Request.prototype.METHOD_POST="POST",a.Http.Request.prototype.SEND_AS_BINARY="BINARY",a.Http.Request.prototype.SEND_AS_RAW="RAW",a.Http.Request.prototype.TYPE_SYNC="sync",a.Http.Request.prototype.TYPE_ASYNC="async",a.Http.Request.prototype.CHARSET_UTF8="UTF-8",a.mode(a.Http.Request.prototype,["MODE_TEXT","MODE_BINARY","METHOD_GET","METHOD_POST","SEND_AS_BINARY","SEND_AS_RAW","TYPE_SYNC","TYPE_SYNC","CHARSET_UTF8"],a.MODE_LOCKED),a.factory(a.Http,"Request",function(){var b=function(b){var c="",d=this.CHARSET_UTF8,e=null,f=this.SEND_AS_RAW,g={},h=this.METHOD_GET,i=this.MODE_TEXT,j=this.TYPE_ASYNC,k=!1,l=new a.Enviroment.Object;a.extend(this,l),this.getUrl=function(){return c},this.setUrl=function(a){return c=a,this},this.getContent=function(){return e},this.setContent=function(a){return e=a,this},this.getCharset=function(){return d},this.setCharset=function(a){return d=a,this},this.getSendAs=function(){return f},this.setSendAs=function(a){return f=a,this},this.getHeaders=function(){return g},this.setHeaders=function(b){var c=a.isArray(b);return a.traverse(b,function(a,b){c?m.setHeader(b):m.setHeader(a,b)}),this},this.getHeader=function(a){return g[a.toLowerCase()]},this.setHeader=function(b,c){if(!a.isDefined(c)){var d=b.search(/:\s*/),e=b.substring(0,d),f=b.substring(d+1);this.setHeader(e.trim(),f.trim())}else g[b.toLowerCase()]=c;return this},this.getMethod=function(){return h},this.setMethod=function(a){return h=a,this},this.getMode=function(){return i},this.setMode=function(a){return i=a,this},this.getType=function(){return j},this.setType=function(a){return j=a,this},this.getBypassCache=function(){return k},this.setBypassCache=function(a){return k=a,this},this.onResponse=new a.Enviroment.Event;var m=this;a.isDefined(b)&&a.traverse(b,function(a,b){switch(a){case"method":m.setMethod(b);break;case"mode":m.setMode(b);break;case"type":m.setType(b);break;case"bypassCache":m.setBypassCache(b)}}),a.mode(this,["onResponse"],a.MODE_LOCKED)};return b.prototype=new a.Http.Request,b.prototype.constructor=a.Http.Request,b},a.MODE_LOCKED),a.Http.ClientInterface=function(a){this.base=function(){},this.dir=function(){},this.request=function(a){},this.info=function(){},this.write=function(){}},a.Http.Client=new a.Http.ClientInterface,a.factory(a.Http.Client,function(){var b=function(a){return a.substring(1)!==""};this.base=function(a,b){var c=a,d=c.charAt(c.length-1);if(d==="/"||d==="\\")c=c.slice(0,-1);return c=c.replace(/^.*[\/\\]/g,""),typeof b=="string"&&c.substr(c.length-b.length)==b&&(c=c.substr(0,c.length-b.length)),c},this.dir=function(a){return a.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")},this.request=function(c){var d=c.getUrl(),e=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!e)throw new Error("XMLHttpRequest not supported");c.getBypassCache()&&(d+=(d.match(/\?/)==null?"?":"&")+(new Date).getTime());var f=new a.Http.Response;f.setHandle(e);var g=e.open(c.getMethod(),d,c.getType()==c.TYPE_ASYNC);c.getType()==c.TYPE_ASYNC&&(e.onreadystatechange=function(a){f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:0,event:a});switch(e.readyState){case 0:break;case 1:break;case 2:break;case 3:f.data("bytes",e.responseText.length*2);break;case 4:e.status>=200&&e.status<400?f.data("bytes",e.responseText.length*2):e.status!==403;break;default:}c.onResponse.notify(f)}),a.traverse(c.getHeaders(),function(a,b){e.setRequestHeader(a,b)});var h=c.getHeader("content-type"),i=c.getCharset(),j=c.getContent();a.flaged(c.MODE_TEXT)?(h||(h="text/html"),i||(i=c.CHARSET_UTF8),/;\s*charset=/.test(h)||(h+="; charset="+i),e.overrideMimeType(h)):a.flaged(c.MODE_BINARY)&&e.overrideMimeType("text/plain; charset=x-user-defined");try{c.getSendAs()==c.SEND_AS_BINARY?e.sendAsBinary(j):e.send(j)}catch(k){return f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:0,error:k}),c.onResponse.notify(f),!1}var l=e.getAllResponseHeaders(),m=[];if(l){l=l.split("\n");for(var n=0;n<l.length;n++)b(l[n])&&m.push(l[n])}return c.getType()!==c.TYPE_ASYNC&&(f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:e.responseText.length*2}),c.onResponse.notify(f)),!0};var c=this}),a.Http};typeof define=="function"&&define.amd?define(["C"],a):typeof module!="undefined"&&module.exports?module.exports=a(require()):window["C.Http"]=a(C)})();
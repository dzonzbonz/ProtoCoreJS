/** @license
 * protocore-js <https://github.com/dzonzbonz/ProtoCoreJS>
 * Author: Nikola Ivanovic - Dzonz Bonz | MIT License
 * v0.0.1 (2015/06/19 09:34)
 */
;(function(){var a=function(a){return a.Http={},a.Http.Response=function(){this.getHandle=function(){},this.setHandle=function(a){},this.getState=function(){},this.setState=function(a){},this.isError=function(a){},this.isSuccess=function(a){},this.isDone=function(a){},this.getHeaders=function(){},this.getResponse=function(){}},a.Http.Response.prototype=new a.Enviroment.EventData,a.Http.Response.prototype.constructor=a.Http.Response,a.factory(a.Http,"Response",function(){function c(a){return a.replace(/^\s+|\s+$/gm,"")}var b=function(a){return a.substring(1)!==""},d=function(){var d=0,e=null,f=new a.Enviroment.EventData;a.extend(this,f),this.getState=function(){return this.data("state")},this.setState=function(a){return this.data("state",a),this},this.getHandle=function(){return e},this.setHandle=function(a){return e=a,this},this.getHeaders=function(){var a=e.getAllResponseHeaders(),d={};if(a){a=a.split("\n");for(var f=0;f<a.length;f++)if(b(a[f])){var g=a[f].search(/:\s*/),h=a[f].substring(0,g),i=a[f].substring(g+1);d[c(h)]=c(i)}}return d},this.getResponse=function(){return this.data("response")},this.isDone=function(){var a=this.getState();return a===4},this.isError=function(){return!this.isSuccess()},this.isSuccess=function(){var a=this.data("status"),b=this.getState();return b===4&&a>=200&&a<400};var g=this};return d.prototype=new a.Http.Response,d.prototype.constructor=a.Http.Response,d},a.MODE_LOCKED),a.Http.Request=function(b){this.MODE_TEXT=1,this.MODE_BINARY=2,this.METHOD_GET="GET",this.METHOD_POST="POST",this.SEND_AS_BINARY="BINARY",this.SEND_AS_RAW="RAW",this.TYPE_SYNC="sync",this.TYPE_ASYNC="async",this.CONTENT_TYPE_JSON="json",this.CONTENT_TYPE_QUERY="query",this.CONTENT_TYPE_FORM="form",this.CHARSET_UTF8="UTF-8",this.getUrl=function(){},this.setUrl=function(a){},this.encodeContent=function(a){},this.getContent=function(){},this.setContent=function(a){},this.getCharset=function(){},this.setCharset=function(a){},this.getHeaders=function(){},this.setHeaders=function(a){},this.getHeader=function(a){},this.setHeader=function(a,b){},this.getMethod=function(){},this.setMethod=function(a){},this.getMode=function(){},this.setMode=function(a){},this.getSendAs=function(){},this.setSendAs=function(a){},this.getType=function(){},this.setType=function(a){},this.getBypassCache=function(){},this.setBypassCache=function(a){},this.onResponse=new a.Http.Response},a.Http.Request.prototype=new a.Enviroment.Object,a.Http.Request.prototype.constructor=a.Http.Request,a.factory(a.Http,"Request",function(){var b={multipartFormData:function(b,c,d,e){var e=a.isDefined(e)?e:a.guid(4);d=a.isDefined(d)?d:1;var f="",g=this;return a.traverse(b,function(b,h){var i=a.isDefined(c)&&c!=null?c+"["+b+"]":b;f+=a.isObject(h)||a.isArray(h)?g.multipartFormData(h,i,d+1,e):"--"+e+"\r\nContent-Disposition: form-data; name="+i+"\r\nContent-type: application/octet-stream"+"\r\n\r\n"+h+"\r\n"}),d==1&&(f+="--"+e+"--\r\n"),f},xWwwFormUrlEncoded:function(b,c,d){d=a.isDefined(d)?d:1;var e="",f=this;return a.traverse(b,function(b,g){var h=a.isDefined(c)&&c!=null?c+"["+b+"]":b;e+=a.isObject(g)||a.isArray(g)?f.xWwwFormUrlEncoded(g,h,d+1):(d===1&&e.length===0?"":"&")+encodeURIComponent(h)+"="+encodeURIComponent(g)}),e},applicationJson:function(a){return JSON.stringify(a)}},c=function(c){var d="",e=this.CHARSET_UTF8,f=null,g=this.SEND_AS_RAW,h={},i=this.METHOD_GET,j=this.MODE_TEXT,k=this.TYPE_ASYNC,l=!1,m=new a.Enviroment.Object;a.extend(this,m),this.getUrl=function(){return d},this.setUrl=function(a){return d=a,this},this.encodeContent=function(a){switch(a){case n.CONTENT_TYPE_FORM:return b.multipartFormData(this.data());case n.CONTENT_TYPE_QUERY:return b.xWwwFormUrlEncoded(this.data());case n.CONTENT_TYPE_JSON:return b.applicationJson(this.data());default:}return null},this.getContent=function(){return f},this.setContent=function(a){return f=a,this},this.getCharset=function(){return e},this.setCharset=function(a){return e=a,this},this.getSendAs=function(){return g},this.setSendAs=function(a){return g=a,this},this.getHeaders=function(){return h},this.setHeaders=function(b){var c=a.isArray(b);return a.traverse(b,function(a,b){c?n.setHeader(b):n.setHeader(a,b)}),this},this.getHeader=function(a){return h[a.toLowerCase()]},this.setHeader=function(b,c){if(!a.isDefined(c)){var d=b.search(/:\s*/),e=b.substring(0,d),f=b.substring(d+1);this.setHeader(e.trim(),f.trim())}else h[b.toLowerCase()]=c;return this},this.getMethod=function(){return i},this.setMethod=function(a){return i=a,this},this.getMode=function(){return j},this.setMode=function(a){return j=a,this},this.getType=function(){return k},this.setType=function(a){return k=a,this},this.getBypassCache=function(){return l},this.setBypassCache=function(a){return l=a,this},this.onResponse=new a.Enviroment.Event;var n=this;a.isDefined(c)&&a.traverse(c,function(a,b){switch(a){case"method":n.setMethod(b);break;case"mode":n.setMode(b);break;case"type":n.setType(b);break;case"bypassCache":n.setBypassCache(b)}})};return c.prototype=new a.Http.Request,c.prototype.constructor=a.Http.Request,c},a.MODE_LOCKED),a.Http.ClientInterface=function(a,b){this.base=function(){},this.dir=function(){},this.request=function(a){},this.info=function(){},this.write=function(){}},a.Http.Client=new a.Http.ClientInterface,a.factory(a.Http.Client,function(){var b=function(a){return a.substring(1)!==""};this.base=function(a,b){var c=a,d=c.charAt(c.length-1);if(d==="/"||d==="\\")c=c.slice(0,-1);return c=c.replace(/^.*[\/\\]/g,""),typeof b=="string"&&c.substr(c.length-b.length)==b&&(c=c.substr(0,c.length-b.length)),c},this.dir=function(a){return a.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")},this.request=function(c){var d=c.getUrl(),e=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!e)throw new Error("XMLHttpRequest not supported");c.getBypassCache()&&(d+=(d.match(/\?/)==null?"?":"&")+(new Date).getTime());var f=new a.Http.Response;f.setHandle(e);var g=e.open(c.getMethod(),d,c.getType()==c.TYPE_ASYNC);c.getType()==c.TYPE_ASYNC&&(e.onreadystatechange=function(a){f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:0,event:a});switch(e.readyState){case 0:break;case 1:break;case 2:break;case 3:f.data("bytes",e.responseText.length*2);break;case 4:e.status>=200&&e.status<400?f.data("bytes",e.responseText.length*2):e.status!==403;break;default:}c.onResponse.notify(f)}),a.traverse(c.getHeaders(),function(a,b){e.setRequestHeader(a,b)});var h=c.getHeader("content-type"),i=c.getCharset(),j=c.getContent();a.flaged(c.MODE_TEXT)?(h||(h="text/html"),i||(i=c.CHARSET_UTF8),/;\s*charset=/.test(h)||(h+="; charset="+i),e.overrideMimeType(h)):a.flaged(c.MODE_BINARY)&&e.overrideMimeType("text/plain; charset=x-user-defined");try{c.getSendAs()==c.SEND_AS_BINARY?e.sendAsBinary(j):e.send(j)}catch(k){return f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:0,error:k}),c.onResponse.notify(f),!1}var l=e.getAllResponseHeaders(),m=[];if(l){l=l.split("\n");for(var n=0;n<l.length;n++)b(l[n])&&m.push(l[n])}return c.getType()!==c.TYPE_ASYNC&&(f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:e.responseText.length*2}),c.onResponse.notify(f)),!0};var c=this}),a.Http};typeof define=="function"&&define.amd?define(["C"],a):typeof module!="undefined"&&module.exports?module.exports=a(require()):window["C.Http"]=a(C)})();
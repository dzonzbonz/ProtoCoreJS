/** @license
 * protocore-js <https://github.com/dzonzbonz/ProtoCoreJS>
 * Author: Nikola Ivanovic - Dzonz Bonz | MIT License
 * v0.0.1 (2015/06/18 22:10)
 */
;(function(){var a=function(a){return a.Http={},a.Http.Response=function(){this.getHandle=function(){},this.setHandle=function(a){},this.getState=function(){},this.setState=function(a){},this.isError=function(a){},this.isSuccess=function(a){},this.getHeaders=function(){}},a.Http.Response.prototype=new a.Enviroment.EventData,a.Http.Response.prototype.constructor=a.Http.Response,a.factory(a.Http,"Response",function(){var b=function(a){return a.substring(1)!==""},c=function(){var c=0,d=null,e=new a.Enviroment.EventData;a.extend(this,e),this.getState=function(){return this.data("state")},this.setState=function(a){return this.data("state",a),this},this.getHandle=function(){return d},this.setHandle=function(a){return d=a,this},this.getHeaders=function(){var a=d.getAllResponseHeaders(),c={};if(a){a=a.split("\n");for(var e=0;e<a.length;e++)if(b(a[e])){var f=a[e].search(/:\s*/),g=a[e].substring(0,f),h=a[e].substring(f+1);c[g]=h}}return c},this.isDone=function(){var a=this.getState();return a==4},this.isSuccess=function(){var a=this.data("status"),b=this.getState();return b==4&&a>=200&&a<400};var f=this};return c.prototype=new a.Http.Response,c.prototype.constructor=a.Http.Response,c},a.MODE_LOCKED),a.Http.Request=function(b){this.MODE_TEXT=1,this.MODE_BINARY=2,this.METHOD_GET="GET",this.METHOD_POST="POST",this.SEND_AS_BINARY="BINARY",this.SEND_AS_RAW="RAW",this.TYPE_SYNC="sync",this.TYPE_ASYNC="async",this.CHARSET_UTF8="UTF-8",this.getUrl=function(){},this.setUrl=function(a){},this.getContent=function(){},this.setContent=function(a){},this.getCharset=function(){},this.setCharset=function(a){},this.getHeaders=function(){},this.setHeaders=function(a){},this.getHeader=function(a){},this.setHeader=function(a,b){},this.getMethod=function(){},this.setMethod=function(a){},this.getMode=function(){},this.setMode=function(a){},this.getSendAs=function(){},this.setSendAs=function(a){},this.getType=function(){},this.setType=function(a){},this.getBypassCache=function(){},this.setBypassCache=function(a){},this.onResponse=new a.Http.Response},a.Http.Request.prototype=new a.Enviroment.Object,a.Http.Request.prototype.constructor=a.Http.Request,a.factory(a.Http,"Request",function(){var b=function(b){var c="",d=this.CHARSET_UTF8,e=null,f=this.SEND_AS_RAW,g={},h=this.METHOD_GET,i=this.MODE_TEXT,j=this.TYPE_ASYNC,k=!1,l=new a.Enviroment.Object;a.extend(this,l),this.getUrl=function(){return c},this.setUrl=function(a){return c=a,this},this.getContent=function(){return e},this.setContent=function(a){return e=a,this},this.getCharset=function(){return d},this.setCharset=function(a){return d=a,this},this.getSendAs=function(){return f},this.setSendAs=function(a){return f=a,this},this.getHeaders=function(){return g},this.setHeaders=function(b){var c=a.isArray(b);return a.traverse(b,function(a,b){c?m.setHeader(b):m.setHeader(a,b)}),this},this.getHeader=function(a){return g[a.toLowerCase()]},this.setHeader=function(b,c){if(!a.isDefined(c)){var d=b.search(/:\s*/),e=b.substring(0,d),f=b.substring(d+1);this.setHeader(e,f)}else g[b.toLowerCase()]=c;return this},this.getMethod=function(){return h},this.setMethod=function(a){return h=a,this},this.getMode=function(){return i},this.setMode=function(a){return i=a,this},this.getType=function(){return j},this.setType=function(a){return j=a,this},this.getBypassCache=function(){return k},this.setBypassCache=function(a){return k=a,this},this.onResponse=new a.Enviroment.Event;var m=this;a.isDefined(b)&&a.traverse(b,function(a,b){switch(a){case"method":m.setMethod(b);break;case"mode":m.setMode(b);break;case"type":m.setType(b);break;case"bypassCache":m.setBypassCache(b)}})};return b.prototype=new a.Http.Request,b.prototype.constructor=a.Http.Request,b},a.MODE_LOCKED),a.Http.ClientInterface=function(a,b){this.base=function(){},this.dir=function(){},this.request=function(a){},this.info=function(){},this.write=function(){}},a.Http.Client=new a.Http.ClientInterface,a.factory(a.Http.Client,function(){var b=function(a){return a.substring(1)!==""};this.base=function(a,b){var c=a,d=c.charAt(c.length-1);if(d==="/"||d==="\\")c=c.slice(0,-1);return c=c.replace(/^.*[\/\\]/g,""),typeof b=="string"&&c.substr(c.length-b.length)==b&&(c=c.substr(0,c.length-b.length)),c},this.dir=function(a){return a.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")},this.request=function(c){var d=c.getUrl(),e=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!e)throw new Error("XMLHttpRequest not supported");c.getBypassCache()&&(d+=(d.match(/\?/)==null?"?":"&")+(new Date).getTime());var f=new a.Http.Response;f.setHandle(e);var g=e.open(c.getMethod(),d,c.getType()==c.TYPE_ASYNC);c.getType()==c.TYPE_ASYNC&&(e.onreadystatechange=function(a){f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:0,event:a});switch(e.readyState){case 0:break;case 1:break;case 2:break;case 3:f.data("bytes",e.responseText.length*2);break;case 4:e.status>=200&&e.status<400?f.data("bytes",e.responseText.length*2):e.status!==403;break;default:}c.onResponse.notify(f)}),a.traverse(c.getHeaders(),function(a,b){e.setRequestHeader(a,b)});var h=c.getHeader("content-type"),i=c.getCharset(),j=c.getContent();a.flaged(c.MODE_TEXT)?(h||(h="text/html"),i||(i=c.CHARSET_UTF8),/;\s*charset=/.test(h)||(h+="; charset="+i),e.overrideMimeType(h)):a.flaged(c.MODE_BINARY)&&e.overrideMimeType("text/plain; charset=x-user-defined");try{c.getSendAs()==c.SEND_AS_BINARY?e.sendAsBinary(j):e.send(j)}catch(k){return!1}var l=e.getAllResponseHeaders(),m=[];if(l){l=l.split("\n");for(var n=0;n<l.length;n++)b(l[n])&&m.push(l[n])}c.getType()!=c.TYPE_ASYNC&&(f.data({state:e.readyState,response:e.responseText,responseXML:e.responseXML,status:e.status,statusText:e.statusText,bytes:e.responseText.length*2}),c.onResponse.notify(f))};var c=this}),a.Http};typeof define=="function"&&define.amd?define(["C"],a):typeof module!="undefined"&&module.exports?module.exports=a(require()):window["C.Http"]=a(C)})();